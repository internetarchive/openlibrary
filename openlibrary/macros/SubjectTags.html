$def with(work, tags=[], edit_mode=False)

$def render_subjects(label, subjects, track_value, prefix="", edit_mode=False):
  $if subjects:
    <div class="section link-box">
      <span class="clamp" data-before="&#9656; ">
        <h3>$label</h3>
        $if edit_mode:
          <button class="edit-subject-btn"
                  data-work-olid="$work.key.split('/')[-1]"
                  title="$_('Manage Subjects')">✏️</button>
        $for subject in subjects:
          <span class="subject-tag">
            <a class="subject-tag__link" href="$subject_name_to_key(subject, prefix=prefix)" data-ol-link-track="$track_value">$subject</a>
          </span>$cond(not loop.last, ",", "")
      </span>
    </div>

$if work:
  $for tag in tags:
    $if tag=="Subjects":
      $:render_subjects(_("Subjects"), work.get_subjects(),"BookOverview|SubjectClick", edit_mode=edit_mode)
    $if tag=="People":
      $:render_subjects(_("People"), work.subject_people,"BookOverview|SubjectPeopleClick", prefix="person:")
    $if tag=="Places":
      $:render_subjects(_("Places"), work.subject_places,"BookOverview|SubjectPlacesClick", prefix="place:")
    $if tag=="Times":
      $:render_subjects(_("Times"), work.subject_times,"BookOverview|SubjectTimesClick", prefix="time:")
