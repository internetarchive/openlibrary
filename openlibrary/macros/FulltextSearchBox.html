$def with(query, results, page=1)


$if results and results.get('hits'):
  $ hits = results['hits'].get('hits', [])
  $ num_found = results['hits'].get('total', 0)
  <div id="searchResults">
    <ul class="list-books">
      $for doc in hits:
      $ ia = doc.get('fields', {}).get('identifier', [''])[0]
      $ snippets = doc.get('highlight', {}).get('text', [''])
      $ page_nums = doc.get('fields', {}).get('page_num', [])
      $ page = ', '.join([str(num) for num in page_nums])

      $if snippets:
        <section class="fulltext-excerpts">
          <ul>
            $for snippet in snippets:
              $if snippet:
                <li class="fulltext-excerpt">
                    &hellip;$:(snippet.replace("<", "&laquo;").replace(">", "&raquo;").replace("{{{", "<mark class='highlight'><strong>").replace("}}}", "</strong></mark>"))&hellip;
                </li>
          </ul>
        </section>
    </ul>
  </div>
