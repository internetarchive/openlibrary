$def with (page=None)

$ show_ol_shell = ctx.get('show_ol_shell', True)

<!--For analytics-->
$ stats = stats_summary()
$ raw_time = stats.get('total', {}).get('time') # Assumes that if total present, it's a dict
$if raw_time is not None:
  $ total_time = float(raw_time) * 1000
$else:
  $ total_time = 0

$if show_ol_shell:
  <div class="clearfix"></div>

$if ("stats" in ctx.features) and query_param('debug'):
    $:render_template("site/stats")

$if show_ol_shell:
  $:render_template("lib/nav_foot", page)

$if not is_bot():
  <script src="/cdn/archive.org/athena.js" type="text/javascript"></script>

<script src="$static_url('build/js/all.js')" type="text/javascript"></script>
<script src="$static_url('build/lit-components/production/ol-components.js')" type="module"></script>

<script>
  // Temporary hotfix for https://github.com/internetarchive/openlibrary/issues/11866
  function initClampers(clampers) {
    for (const clamper of clampers) {
        if (clamper.clientHeight === clamper.scrollHeight) {
            clamper.classList.remove('clamp')
        } else {
            /*
                Clamper shows used to show more/less by toggling `hidden`
                style on parent .clamp tag
            */
            $$(clamper).on('click', function (event) {
                const up = $$(this);

                // prevent the subjects from collapsing/expanding when the <a> link is being clicked
                if (event.target.nodeName === 'A') {
                    return
                }

                if (up.hasClass('clamp')) {
                    clamper.style.display = clamper.style.display === '-webkit-box' || clamper.style.display === '' ? 'unset' : '-webkit-box'

                    if (up.attr('data-before') === '\u25BE ') {
                        up.attr('data-before', '\u25B8 ')
                    } else {
                        up.attr('data-before', '\u25BE ')
                    }
                }
            })
        }
    }
  }
  initClampers(document.querySelectorAll('.clamp'));
</script>

<div class="analytics-stats-time-calculator" data-time="$total_time"></div>
</body>
</html>
